"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/layout",{

/***/ "(app-pages-browser)/./src/styles/globals.css":
/*!********************************!*\
  !*** ./src/styles/globals.css ***!
  \********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = (\"68f722c16c48\");\nif (true) { module.hot.accept() }\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9zdHlsZXMvZ2xvYmFscy5jc3MiLCJtYXBwaW5ncyI6IjtBQUFBLCtEQUFlLGNBQWM7QUFDN0IsSUFBSSxJQUFVLElBQUksaUJBQWlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9zdHlsZXMvZ2xvYmFscy5jc3M/NjdmNSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBcIjY4ZjcyMmMxNmM0OFwiXG5pZiAobW9kdWxlLmhvdCkgeyBtb2R1bGUuaG90LmFjY2VwdCgpIH1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/styles/globals.css\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/components/ChatWidget.tsx":
/*!***************************************!*\
  !*** ./src/components/ChatWidget.tsx ***!
  \***************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ ChatWidget; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! __barrel_optimize__?names=Bot,MessageCircle,Send,Settings,User,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/x.js\");\n/* harmony import */ var _barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! __barrel_optimize__?names=Bot,MessageCircle,Send,Settings,User,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/message-circle.js\");\n/* harmony import */ var _barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! __barrel_optimize__?names=Bot,MessageCircle,Send,Settings,User,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/bot.js\");\n/* harmony import */ var _barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! __barrel_optimize__?names=Bot,MessageCircle,Send,Settings,User,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/settings.js\");\n/* harmony import */ var _barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! __barrel_optimize__?names=Bot,MessageCircle,Send,Settings,User,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/user.js\");\n/* harmony import */ var _barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! __barrel_optimize__?names=Bot,MessageCircle,Send,Settings,User,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/send.js\");\n/* harmony import */ var next_link__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/link */ \"(app-pages-browser)/./node_modules/next/dist/api/link.js\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$(), _s1 = $RefreshSig$();\n\n\n\n// Hook seguro que no lanza error si no hay AuthProvider\nfunction useAuthSafe() {\n    _s();\n    const [authState, setAuthState] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n        user: null,\n        isAuthenticated: false\n    });\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        try {\n            const savedUser = localStorage.getItem(\"user\");\n            const savedToken = localStorage.getItem(\"token\") || localStorage.getItem(\"auth-token\");\n            if (savedUser && savedToken) {\n                const user = JSON.parse(savedUser);\n                setAuthState({\n                    user,\n                    isAuthenticated: true\n                });\n            }\n        } catch (e) {\n        // Ignorar errores\n        }\n    }, []);\n    return authState;\n}\n_s(useAuthSafe, \"dxMSMTbPosCPEnqMJIdrZCzsxpA=\");\nconst QUICK_REPLIES = [\n    \"\\xbfCual es el mejor corte para asar?\",\n    \"\\xbfTienen envio gratis?\",\n    \"\\xbfComo preparo un ribeye?\",\n    \"Recomiendame un corte\"\n];\nconst MEAT_KNOWLEDGE = {\n    \"ribeye\": \"El **Ribeye** es uno de los cortes mas jugosos y sabrosos. Tiene excelente marmoleo (grasa intramuscular) que le da sabor. Ideal para la parrilla a fuego alto, 3-4 min por lado para termino medio.\",\n    \"arrachera\": \"La **Arrachera** es perfecta para tacos y fajitas. Marinala por al menos 2 horas y cocinala a fuego alto por 3-4 minutos por lado. Cortala en contra de la fibra.\",\n    \"new york\": \"El **New York** o Strip tiene menos grasa que el ribeye pero es muy tierno. Perfecto para parrilla, sazona con sal gruesa y pimienta antes de cocinar.\",\n    \"t-bone\": \"El **T-Bone** incluye dos cortes: el filete y el New York, separados por un hueso en forma de T. Ideal para parrilla, cocina primero el lado del filete.\",\n    \"filete\": \"El **Filete Mignon** es el corte mas tierno. Tiene poca grasa asi que no lo cocines de mas. Ideal termino medio-rojo.\",\n    \"asado\": \"Para **asar** recomiendo: Ribeye (jugoso), Arrachera (para tacos), T-Bone (dos cortes en uno), o New York (balance perfecto).\",\n    \"envio\": \"Ofrecemos **envio gratis** en pedidos mayores a $999 MXN. Los pedidos se entregan en 24-48 horas con empaque refrigerado para mantener la cadena de frio.\",\n    \"preparar\": \"Tips generales: 1) Saca la carne del refri 30 min antes, 2) Seca bien la superficie, 3) Sazona justo antes de cocinar, 4) Deja reposar 5 min despues de cocinar.\",\n    \"recomendar\": \"\\xbfPara que ocasion buscas?\\n\\n- **Parrillada familiar**: Arrachera o Ribeye\\n- **Cena romantica**: Filete Mignon\\n- **Tacos/Fajitas**: Arrachera marinada\\n- **Impresionar invitados**: T-Bone o Tomahawk\",\n    \"precio\": \"Los precios varian segun el corte y peso. Visita nuestra seccion de productos para ver precios actualizados. Tenemos ofertas especiales para miembros!\",\n    \"membresia\": \"Nuestra **membresia premium** incluye: 10% descuento en todos los productos, envio gratis siempre, acceso a cortes exclusivos y puntos dobles en cada compra.\"\n};\nfunction getLocalBotResponse(userMessage) {\n    const msg = userMessage.toLowerCase();\n    if (msg.includes(\"hola\") || msg.includes(\"buenos\") || msg.includes(\"hi\")) {\n        return \"Hola! Soy el asistente de Carnes Premium. \\xbfEn que puedo ayudarte hoy? Puedo recomendarte cortes, explicarte como prepararlos o ayudarte con tu pedido.\";\n    }\n    for (const [key, response] of Object.entries(MEAT_KNOWLEDGE)){\n        if (msg.includes(key)) {\n            return response;\n        }\n    }\n    if (msg.includes(\"asar\") || msg.includes(\"parrilla\") || msg.includes(\"grill\")) {\n        return MEAT_KNOWLEDGE[\"asado\"];\n    }\n    if (msg.includes(\"envio\") || msg.includes(\"entrega\") || msg.includes(\"gratis\")) {\n        return MEAT_KNOWLEDGE[\"envio\"];\n    }\n    if (msg.includes(\"preparar\") || msg.includes(\"cocinar\") || msg.includes(\"hacer\") || msg.includes(\"como\")) {\n        return MEAT_KNOWLEDGE[\"preparar\"];\n    }\n    if (msg.includes(\"recomienda\") || msg.includes(\"sugieres\") || msg.includes(\"mejor\") || msg.includes(\"cual\")) {\n        return MEAT_KNOWLEDGE[\"recomendar\"];\n    }\n    if (msg.includes(\"precio\") || msg.includes(\"cuesta\") || msg.includes(\"cuanto\") || msg.includes(\"valor\")) {\n        return MEAT_KNOWLEDGE[\"precio\"];\n    }\n    if (msg.includes(\"membresia\") || msg.includes(\"premium\") || msg.includes(\"beneficio\")) {\n        return MEAT_KNOWLEDGE[\"membresia\"];\n    }\n    if (msg.includes(\"gracias\") || msg.includes(\"thanks\")) {\n        return \"Con gusto! Si tienes mas preguntas sobre nuestros cortes o necesitas ayuda con tu pedido, aqui estoy.\";\n    }\n    if (msg.includes(\"adios\") || msg.includes(\"bye\") || msg.includes(\"chao\")) {\n        return \"Hasta pronto! Gracias por visitar Carnes Premium. Que disfrutes tu asado!\";\n    }\n    return \"Interesante pregunta. Puedo ayudarte con:\\n\\n- Informacion sobre cortes de carne\\n- Recomendaciones segun la ocasion\\n- Tips de preparacion\\n- Informacion de envios\\n- Detalles de membresia\\n\\n\\xbfSobre que te gustaria saber mas?\";\n}\nfunction ChatWidget() {\n    _s1();\n    const { user, isAuthenticated } = useAuthSafe();\n    const [isOpen, setIsOpen] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([\n        {\n            id: \"1\",\n            text: \"Hola! Soy tu asistente de Carnes Premium. \\xbfEn que puedo ayudarte hoy?\",\n            sender: \"bot\",\n            timestamp: new Date()\n        }\n    ]);\n    const [inputValue, setInputValue] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isTyping, setIsTyping] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [chatConfig, setChatConfig] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n        provider: \"none\"\n    });\n    const [chatHistory, setChatHistory] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const messagesEndRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    // Verificar si el usuario actual es administrador\n    const isAdmin = isAuthenticated && (user === null || user === void 0 ? void 0 : user.role) === \"ADMIN\";\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const saved = localStorage.getItem(\"chatConfig\");\n        if (saved) {\n            setChatConfig(JSON.parse(saved));\n        }\n    }, []);\n    const scrollToBottom = ()=>{\n        var _messagesEndRef_current;\n        (_messagesEndRef_current = messagesEndRef.current) === null || _messagesEndRef_current === void 0 ? void 0 : _messagesEndRef_current.scrollIntoView({\n            behavior: \"smooth\"\n        });\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        scrollToBottom();\n    }, [\n        messages\n    ]);\n    const callAIAPI = async (message)=>{\n        try {\n            const response = await fetch(\"\".concat(\"http://localhost:3002/api\" || 0, \"/chat\"), {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    message,\n                    history: chatHistory,\n                    provider: chatConfig.provider\n                })\n            });\n            const data = await response.json();\n            if (data.error && !data.message) {\n                throw new Error(data.error);\n            }\n            return data.message;\n        } catch (error) {\n            console.error(\"AI API Error:\", error);\n            return getLocalBotResponse(message);\n        }\n    };\n    const handleSend = async (text)=>{\n        const messageText = text || inputValue.trim();\n        if (!messageText) return;\n        const userMessage = {\n            id: Date.now().toString(),\n            text: messageText,\n            sender: \"user\",\n            timestamp: new Date()\n        };\n        setMessages((prev)=>[\n                ...prev,\n                userMessage\n            ]);\n        setInputValue(\"\");\n        setChatHistory((prev)=>[\n                ...prev,\n                {\n                    role: \"user\",\n                    content: messageText\n                }\n            ]);\n        setIsTyping(true);\n        let botResponse;\n        if (chatConfig.provider !== \"none\" && (chatConfig.openaiApiKey || chatConfig.minimaxApiKey)) {\n            botResponse = await callAIAPI(messageText);\n        } else {\n            await new Promise((resolve)=>setTimeout(resolve, 600 + Math.random() * 400));\n            botResponse = getLocalBotResponse(messageText);\n        }\n        setIsTyping(false);\n        const botMessage = {\n            id: (Date.now() + 1).toString(),\n            text: botResponse,\n            sender: \"bot\",\n            timestamp: new Date()\n        };\n        setMessages((prev)=>[\n                ...prev,\n                botMessage\n            ]);\n        setChatHistory((prev)=>[\n                ...prev,\n                {\n                    role: \"assistant\",\n                    content: botResponse\n                }\n            ]);\n    };\n    const handleKeyPress = (e)=>{\n        if (e.key === \"Enter\" && !e.shiftKey) {\n            e.preventDefault();\n            handleSend();\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                onClick: ()=>setIsOpen(!isOpen),\n                className: \"fixed bottom-6 right-6 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 \".concat(isOpen ? \"bg-gray-600 rotate-90\" : \"bg-red-600 hover:bg-red-700 hover:scale-110\"),\n                children: isOpen ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n                    className: \"w-6 h-6 text-white\"\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                    lineNumber: 226,\n                    columnNumber: 11\n                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n                    className: \"w-6 h-6 text-white\"\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                    lineNumber: 228,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                lineNumber: 219,\n                columnNumber: 7\n            }, this),\n            isOpen && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"fixed bottom-24 right-6 z-50 w-96 max-w-[calc(100vw-2rem)] bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-200\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"bg-gradient-to-r from-red-600 to-red-700 p-4 text-white\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex items-center justify-between\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex items-center space-x-3\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center\",\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n                                                className: \"w-6 h-6\"\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                lineNumber: 238,\n                                                columnNumber: 19\n                                            }, this)\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                            lineNumber: 237,\n                                            columnNumber: 17\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                                                    className: \"font-semibold\",\n                                                    children: \"Asistente Premium\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                    lineNumber: 241,\n                                                    columnNumber: 19\n                                                }, this),\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                    className: \"text-xs text-red-100\",\n                                                    children: chatConfig.provider !== \"none\" ? \"IA: \".concat(chatConfig.provider) : \"Tu experto en carnes\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                    lineNumber: 242,\n                                                    columnNumber: 19\n                                                }, this)\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                            lineNumber: 240,\n                                            columnNumber: 17\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                    lineNumber: 236,\n                                    columnNumber: 15\n                                }, this),\n                                isAdmin && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_link__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n                                    href: \"/admin/settings/chat\",\n                                    className: \"p-2 hover:bg-white/20 rounded-full transition-colors\",\n                                    title: \"Configurar chatbot\",\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n                                        className: \"w-4 h-4\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                        lineNumber: 253,\n                                        columnNumber: 19\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                    lineNumber: 248,\n                                    columnNumber: 17\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                            lineNumber: 235,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                        lineNumber: 234,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"h-80 overflow-y-auto p-4 space-y-4 bg-gray-50\",\n                        children: [\n                            messages.map((message)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex \".concat(message.sender === \"user\" ? \"justify-end\" : \"justify-start\"),\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex items-start space-x-2 max-w-[80%] \".concat(message.sender === \"user\" ? \"flex-row-reverse space-x-reverse\" : \"\"),\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 \".concat(message.sender === \"user\" ? \"bg-red-600\" : \"bg-gray-200\"),\n                                                children: message.sender === \"user\" ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n                                                    className: \"w-4 h-4 text-white\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                    lineNumber: 276,\n                                                    columnNumber: 23\n                                                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n                                                    className: \"w-4 h-4 text-gray-600\"\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                    lineNumber: 278,\n                                                    columnNumber: 23\n                                                }, this)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                lineNumber: 270,\n                                                columnNumber: 19\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"p-3 rounded-2xl \".concat(message.sender === \"user\" ? \"bg-red-600 text-white rounded-tr-sm\" : \"bg-white text-gray-800 rounded-tl-sm shadow-sm\"),\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                    className: \"text-sm whitespace-pre-line\",\n                                                    children: message.text\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                    lineNumber: 288,\n                                                    columnNumber: 21\n                                                }, this)\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                lineNumber: 281,\n                                                columnNumber: 19\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                        lineNumber: 265,\n                                        columnNumber: 17\n                                    }, this)\n                                }, message.id, false, {\n                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                    lineNumber: 261,\n                                    columnNumber: 15\n                                }, this)),\n                            isTyping && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex justify-start\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex items-center space-x-2\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center\",\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n                                                className: \"w-4 h-4 text-gray-600\"\n                                            }, void 0, false, {\n                                                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                lineNumber: 298,\n                                                columnNumber: 21\n                                            }, this)\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                            lineNumber: 297,\n                                            columnNumber: 19\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"bg-white p-3 rounded-2xl rounded-tl-sm shadow-sm\",\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"flex space-x-1\",\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        className: \"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",\n                                                        style: {\n                                                            animationDelay: \"0ms\"\n                                                        }\n                                                    }, void 0, false, {\n                                                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                        lineNumber: 302,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        className: \"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",\n                                                        style: {\n                                                            animationDelay: \"150ms\"\n                                                        }\n                                                    }, void 0, false, {\n                                                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                        lineNumber: 303,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        className: \"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",\n                                                        style: {\n                                                            animationDelay: \"300ms\"\n                                                        }\n                                                    }, void 0, false, {\n                                                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                        lineNumber: 304,\n                                                        columnNumber: 23\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                                lineNumber: 301,\n                                                columnNumber: 21\n                                            }, this)\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                            lineNumber: 300,\n                                            columnNumber: 19\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                    lineNumber: 296,\n                                    columnNumber: 17\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                lineNumber: 295,\n                                columnNumber: 15\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                ref: messagesEndRef\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                lineNumber: 311,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                        lineNumber: 259,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"px-4 py-2 border-t border-gray-100 bg-white\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex flex-wrap gap-2\",\n                            children: QUICK_REPLIES.map((reply, index)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>handleSend(reply),\n                                    className: \"text-xs px-3 py-1.5 bg-gray-100 hover:bg-red-50 hover:text-red-600 rounded-full transition-colors\",\n                                    children: reply\n                                }, index, false, {\n                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                    lineNumber: 317,\n                                    columnNumber: 17\n                                }, this))\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                            lineNumber: 315,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                        lineNumber: 314,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"p-4 border-t border-gray-200 bg-white\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex items-center space-x-2\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                    type: \"text\",\n                                    value: inputValue,\n                                    onChange: (e)=>setInputValue(e.target.value),\n                                    onKeyPress: handleKeyPress,\n                                    placeholder: \"Escribe tu pregunta...\",\n                                    className: \"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                    lineNumber: 330,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>handleSend(),\n                                    disabled: !inputValue.trim(),\n                                    className: \"w-10 h-10 bg-red-600 hover:bg-red-700 disabled:bg-gray-300 rounded-full flex items-center justify-center transition-colors\",\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Bot_MessageCircle_Send_Settings_User_X_lucide_react__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n                                        className: \"w-4 h-4 text-white\"\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                        lineNumber: 343,\n                                        columnNumber: 17\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                                    lineNumber: 338,\n                                    columnNumber: 15\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                            lineNumber: 329,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                        lineNumber: 328,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\Administrador\\\\Downloads\\\\CARNES PREMIUM\\\\frontend-simple\\\\src\\\\components\\\\ChatWidget.tsx\",\n                lineNumber: 233,\n                columnNumber: 9\n            }, this)\n        ]\n    }, void 0, true);\n} /*'use client';\r\n\r\nimport { useState, useRef, useEffect } from 'react';\r\nimport { MessageCircle, X, Send, Bot, User, Settings } from 'lucide-react';\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/context/AuthContext';\r\n\r\ninterface Message {\r\n  id: string;\r\n  text: string;\r\n  sender: 'user' | 'bot';\r\n  timestamp: Date;\r\n}\r\n\r\ninterface ChatConfig {\r\n  provider: 'openai' | 'minimax' | 'none';\r\n  openaiApiKey?: string;\r\n  minimaxApiKey?: string;\r\n}\r\n\r\nconst QUICK_REPLIES = [\r\n  '¿Cual es el mejor corte para asar?',\r\n  '¿Tienen envio gratis?',\r\n  '¿Como preparo un ribeye?',\r\n  'Recomiendame un corte',\r\n];\r\n\r\nconst MEAT_KNOWLEDGE: Record<string, string> = {\r\n  'ribeye': 'El **Ribeye** es uno de los cortes mas jugosos y sabrosos. Tiene excelente marmoleo (grasa intramuscular) que le da sabor. Ideal para la parrilla a fuego alto, 3-4 min por lado para termino medio.',\r\n  'arrachera': 'La **Arrachera** es perfecta para tacos y fajitas. Marinala por al menos 2 horas y cocinala a fuego alto por 3-4 minutos por lado. Cortala en contra de la fibra.',\r\n  'new york': 'El **New York** o Strip tiene menos grasa que el ribeye pero es muy tierno. Perfecto para parrilla, sazona con sal gruesa y pimienta antes de cocinar.',\r\n  't-bone': 'El **T-Bone** incluye dos cortes: el filete y el New York, separados por un hueso en forma de T. Ideal para parrilla, cocina primero el lado del filete.',\r\n  'filete': 'El **Filete Mignon** es el corte mas tierno. Tiene poca grasa asi que no lo cocines de mas. Ideal termino medio-rojo.',\r\n  'asado': 'Para **asar** recomiendo: Ribeye (jugoso), Arrachera (para tacos), T-Bone (dos cortes en uno), o New York (balance perfecto).',\r\n  'envio': 'Ofrecemos **envio gratis** en pedidos mayores a $999 MXN. Los pedidos se entregan en 24-48 horas con empaque refrigerado para mantener la cadena de frio.',\r\n  'preparar': 'Tips generales: 1) Saca la carne del refri 30 min antes, 2) Seca bien la superficie, 3) Sazona justo antes de cocinar, 4) Deja reposar 5 min despues de cocinar.',\r\n  'recomendar': '¿Para que ocasion buscas?\\n\\n- **Parrillada familiar**: Arrachera o Ribeye\\n- **Cena romantica**: Filete Mignon\\n- **Tacos/Fajitas**: Arrachera marinada\\n- **Impresionar invitados**: T-Bone o Tomahawk',\r\n  'precio': 'Los precios varian segun el corte y peso. Visita nuestra seccion de productos para ver precios actualizados. Tenemos ofertas especiales para miembros!',\r\n  'membresia': 'Nuestra **membresia premium** incluye: 10% descuento en todos los productos, envio gratis siempre, acceso a cortes exclusivos y puntos dobles en cada compra.',\r\n};\r\n\r\nfunction getLocalBotResponse(userMessage: string): string {\r\n  const msg = userMessage.toLowerCase();\r\n  \r\n  if (msg.includes('hola') || msg.includes('buenos') || msg.includes('hi')) {\r\n    return 'Hola! Soy el asistente de Carnes Premium. ¿En que puedo ayudarte hoy? Puedo recomendarte cortes, explicarte como prepararlos o ayudarte con tu pedido.';\r\n  }\r\n  \r\n  for (const [key, response] of Object.entries(MEAT_KNOWLEDGE)) {\r\n    if (msg.includes(key)) {\r\n      return response;\r\n    }\r\n  }\r\n  \r\n  if (msg.includes('asar') || msg.includes('parrilla') || msg.includes('grill')) {\r\n    return MEAT_KNOWLEDGE['asado'];\r\n  }\r\n  \r\n  if (msg.includes('envio') || msg.includes('entrega') || msg.includes('gratis')) {\r\n    return MEAT_KNOWLEDGE['envio'];\r\n  }\r\n  \r\n  if (msg.includes('preparar') || msg.includes('cocinar') || msg.includes('hacer') || msg.includes('como')) {\r\n    return MEAT_KNOWLEDGE['preparar'];\r\n  }\r\n  \r\n  if (msg.includes('recomienda') || msg.includes('sugieres') || msg.includes('mejor') || msg.includes('cual')) {\r\n    return MEAT_KNOWLEDGE['recomendar'];\r\n  }\r\n  \r\n  if (msg.includes('precio') || msg.includes('cuesta') || msg.includes('cuanto') || msg.includes('valor')) {\r\n    return MEAT_KNOWLEDGE['precio'];\r\n  }\r\n  \r\n  if (msg.includes('membresia') || msg.includes('premium') || msg.includes('beneficio')) {\r\n    return MEAT_KNOWLEDGE['membresia'];\r\n  }\r\n  \r\n  if (msg.includes('gracias') || msg.includes('thanks')) {\r\n    return 'Con gusto! Si tienes mas preguntas sobre nuestros cortes o necesitas ayuda con tu pedido, aqui estoy.';\r\n  }\r\n  \r\n  if (msg.includes('adios') || msg.includes('bye') || msg.includes('chao')) {\r\n    return 'Hasta pronto! Gracias por visitar Carnes Premium. Que disfrutes tu asado!';\r\n  }\r\n  \r\n  return 'Interesante pregunta. Puedo ayudarte con:\\n\\n- Informacion sobre cortes de carne\\n- Recomendaciones segun la ocasion\\n- Tips de preparacion\\n- Informacion de envios\\n- Detalles de membresia\\n\\n¿Sobre que te gustaria saber mas?';\r\n}\r\n\r\nexport default function ChatWidget() {\r\n  const { user, isAuthenticated } = useAuth(); \r\n  const [isOpen, setIsOpen] = useState(false);  \r\n  const [messages, setMessages] = useState<Message[]>([\r\n    {\r\n      id: '1',\r\n      text: 'Hola! Soy tu asistente de Carnes Premium. ¿En que puedo ayudarte hoy?',\r\n      sender: 'bot',\r\n      timestamp: new Date(),\r\n    },\r\n  ]);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [chatConfig, setChatConfig] = useState<ChatConfig>({ provider: 'none' });\r\n  const [chatHistory, setChatHistory] = useState<Array<{ role: string; content: string }>>([]);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const isAdmin = isAuthenticated && user?.role === 'ADMIN'; \r\n\r\n\r\n  useEffect(() => {\r\n    \r\n    const saved = localStorage.getItem('chatConfig');\r\n    if (saved) {\r\n      setChatConfig(JSON.parse(saved));\r\n    }\r\n  }, []);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const callAIAPI = async (message: string): Promise<string> => {\r\n    try {\r\n      const response = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3002/api'}/chat`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          message,\r\n          history: chatHistory,\r\n          provider: chatConfig.provider,\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (data.error && !data.message) {\r\n        throw new Error(data.error);\r\n      }\r\n      \r\n      return data.message;\r\n    } catch (error) {\r\n      console.error('AI API Error:', error);\r\n      return getLocalBotResponse(message);\r\n    }\r\n  };\r\n\r\n  const handleSend = async (text?: string) => {\r\n    const messageText = text || inputValue.trim();\r\n    if (!messageText) return;\r\n\r\n    const userMessage: Message = {\r\n      id: Date.now().toString(),\r\n      text: messageText,\r\n      sender: 'user',\r\n      timestamp: new Date(),\r\n    };\r\n    setMessages((prev) => [...prev, userMessage]);\r\n    setInputValue('');\r\n    setChatHistory((prev) => [...prev, { role: 'user', content: messageText }]);\r\n    setIsTyping(true);\r\n\r\n    let botResponse: string;\r\n\r\n    if (chatConfig.provider !== 'none' && (chatConfig.openaiApiKey || chatConfig.minimaxApiKey)) {\r\n      botResponse = await callAIAPI(messageText);\r\n    } else {\r\n      await new Promise((resolve) => setTimeout(resolve, 600 + Math.random() * 400));\r\n      botResponse = getLocalBotResponse(messageText);\r\n    }\r\n\r\n    setIsTyping(false);\r\n\r\n    const botMessage: Message = {\r\n      id: (Date.now() + 1).toString(),\r\n      text: botResponse,\r\n      sender: 'bot',\r\n      timestamp: new Date(),\r\n    };\r\n    setMessages((prev) => [...prev, botMessage]);\r\n    setChatHistory((prev) => [...prev, { role: 'assistant', content: botResponse }]);\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSend();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className={`fixed bottom-6 right-6 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 ${\r\n          isOpen ? 'bg-gray-600 rotate-90' : 'bg-red-600 hover:bg-red-700 hover:scale-110'\r\n        }`}\r\n      >\r\n        {isOpen ? <X className=\"w-6 h-6 text-white\" /> : <MessageCircle className=\"w-6 h-6 text-white\" />}\r\n      </button>\r\n\r\n      {isOpen && (\r\n        <div className=\"fixed bottom-24 right-6 z-50 w-96 max-w-[calc(100vw-2rem)] bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-200\">\r\n          <div className=\"bg-gradient-to-r from-red-600 to-red-700 p-4 text-white\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center\">\r\n                  <Bot className=\"w-6 h-6\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold\">Asistente Premium</h3>\r\n                  <p className=\"text-xs text-red-100\">\r\n                    {chatConfig.provider !== 'none' ? `IA: ${chatConfig.provider}` : 'Tu experto en carnes'}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <Link href=\"/admin/settings/chat\" className=\"p-2 hover:bg-white/20 rounded-full transition-colors\" title=\"Configurar chatbot\">\r\n                <Settings className=\"w-4 h-4\" />\r\n              </Link>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"h-80 overflow-y-auto p-4 space-y-4 bg-gray-50\">\r\n            {messages.map((message) => (\r\n              <div key={message.id} className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'}`}>\r\n                <div className={`flex items-start space-x-2 max-w-[80%] ${message.sender === 'user' ? 'flex-row-reverse space-x-reverse' : ''}`}>\r\n                  <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${message.sender === 'user' ? 'bg-red-600' : 'bg-gray-200'}`}>\r\n                    {message.sender === 'user' ? <User className=\"w-4 h-4 text-white\" /> : <Bot className=\"w-4 h-4 text-gray-600\" />}\r\n                  </div>\r\n                  <div className={`p-3 rounded-2xl ${message.sender === 'user' ? 'bg-red-600 text-white rounded-tr-sm' : 'bg-white text-gray-800 rounded-tl-sm shadow-sm'}`}>\r\n                    <p className=\"text-sm whitespace-pre-line\">{message.text}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n            \r\n            {isTyping && ( \r\n              <div className=\"flex justify-start\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <div className=\"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center\">\r\n                    <Bot className=\"w-4 h-4 text-gray-600\" />\r\n                  </div>\r\n                  <div className=\"bg-white p-3 rounded-2xl rounded-tl-sm shadow-sm\">\r\n                    <div className=\"flex space-x-1\">\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0ms' }}></div>\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '150ms' }}></div>\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '300ms' }}></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <div ref={messagesEndRef} />\r\n          </div>\r\n\r\n          <div className=\"px-4 py-2 border-t border-gray-100 bg-white\">\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {QUICK_REPLIES.map((reply, index) => (\r\n                <button key={index} onClick={() => handleSend(reply)} className=\"text-xs px-3 py-1.5 bg-gray-100 hover:bg-red-50 hover:text-red-600 rounded-full transition-colors\">\r\n                  {reply}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"p-4 border-t border-gray-200 bg-white\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <input\r\n                type=\"text\"\r\n                value={inputValue}\r\n                onChange={(e) => setInputValue(e.target.value)}\r\n                onKeyPress={handleKeyPress}\r\n                placeholder=\"Escribe tu pregunta...\"\r\n                className=\"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm\"\r\n              />\r\n              <button onClick={() => handleSend()} disabled={!inputValue.trim()} className=\"w-10 h-10 bg-red-600 hover:bg-red-700 disabled:bg-gray-300 rounded-full flex items-center justify-center transition-colors\">\r\n                <Send className=\"w-4 h-4 text-white\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}*/ \n_s1(ChatWidget, \"okRqzxbWUYggkAb45F/VhOHBquQ=\", false, function() {\n    return [\n        useAuthSafe\n    ];\n});\n_c = ChatWidget;\nvar _c;\n$RefreshReg$(_c, \"ChatWidget\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb21wb25lbnRzL0NoYXRXaWRnZXQudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFZ0U7QUFDVztBQUM5QztBQUU3Qix3REFBd0Q7QUFDeEQsU0FBU1U7O0lBQ1AsTUFBTSxDQUFDQyxXQUFXQyxhQUFhLEdBQUdaLCtDQUFRQSxDQUEwQztRQUNsRmEsTUFBTTtRQUNOQyxpQkFBaUI7SUFDbkI7SUFFQVosZ0RBQVNBLENBQUM7UUFDUixJQUFJO1lBQ0YsTUFBTWEsWUFBWUMsYUFBYUMsT0FBTyxDQUFDO1lBQ3ZDLE1BQU1DLGFBQWFGLGFBQWFDLE9BQU8sQ0FBQyxZQUFZRCxhQUFhQyxPQUFPLENBQUM7WUFDekUsSUFBSUYsYUFBYUcsWUFBWTtnQkFDM0IsTUFBTUwsT0FBT00sS0FBS0MsS0FBSyxDQUFDTDtnQkFDeEJILGFBQWE7b0JBQUVDO29CQUFNQyxpQkFBaUI7Z0JBQUs7WUFDN0M7UUFDRixFQUFFLFVBQU07UUFDTixrQkFBa0I7UUFDcEI7SUFDRixHQUFHLEVBQUU7SUFFTCxPQUFPSDtBQUNUO0dBcEJTRDtBQW1DVCxNQUFNVyxnQkFBZ0I7SUFDcEI7SUFDQTtJQUNBO0lBQ0E7Q0FDRDtBQUVELE1BQU1DLGlCQUF5QztJQUM3QyxVQUFVO0lBQ1YsYUFBYTtJQUNiLFlBQVk7SUFDWixVQUFVO0lBQ1YsVUFBVTtJQUNWLFNBQVM7SUFDVCxTQUFTO0lBQ1QsWUFBWTtJQUNaLGNBQWM7SUFDZCxVQUFVO0lBQ1YsYUFBYTtBQUNmO0FBRUEsU0FBU0Msb0JBQW9CQyxXQUFtQjtJQUM5QyxNQUFNQyxNQUFNRCxZQUFZRSxXQUFXO0lBRW5DLElBQUlELElBQUlFLFFBQVEsQ0FBQyxXQUFXRixJQUFJRSxRQUFRLENBQUMsYUFBYUYsSUFBSUUsUUFBUSxDQUFDLE9BQU87UUFDeEUsT0FBTztJQUNUO0lBRUEsS0FBSyxNQUFNLENBQUNDLEtBQUtDLFNBQVMsSUFBSUMsT0FBT0MsT0FBTyxDQUFDVCxnQkFB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Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Q0ErUkM7SUF0aEJ1QmpFOztRQUNZdEI7OztLQURac0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2NvbXBvbmVudHMvQ2hhdFdpZGdldC50c3g/N2Y2YiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCc7XHJcblxyXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VFZmZlY3QsIHVzZUNvbnRleHQgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IE1lc3NhZ2VDaXJjbGUsIFgsIFNlbmQsIEJvdCwgVXNlciwgU2V0dGluZ3MgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xyXG5pbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnO1xyXG5cclxuLy8gSG9vayBzZWd1cm8gcXVlIG5vIGxhbnphIGVycm9yIHNpIG5vIGhheSBBdXRoUHJvdmlkZXJcclxuZnVuY3Rpb24gdXNlQXV0aFNhZmUoKSB7XHJcbiAgY29uc3QgW2F1dGhTdGF0ZSwgc2V0QXV0aFN0YXRlXSA9IHVzZVN0YXRlPHsgdXNlcjogYW55OyBpc0F1dGhlbnRpY2F0ZWQ6IGJvb2xlYW4gfT4oe1xyXG4gICAgdXNlcjogbnVsbCxcclxuICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXHJcbiAgfSk7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzYXZlZFVzZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpO1xyXG4gICAgICBjb25zdCBzYXZlZFRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2F1dGgtdG9rZW4nKTtcclxuICAgICAgaWYgKHNhdmVkVXNlciAmJiBzYXZlZFRva2VuKSB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IEpTT04ucGFyc2Uoc2F2ZWRVc2VyKTtcclxuICAgICAgICBzZXRBdXRoU3RhdGUoeyB1c2VyLCBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2gge1xyXG4gICAgICAvLyBJZ25vcmFyIGVycm9yZXNcclxuICAgIH1cclxuICB9LCBbXSk7XHJcblxyXG4gIHJldHVybiBhdXRoU3RhdGU7XHJcbn1cclxuXHJcbmludGVyZmFjZSBNZXNzYWdlIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRleHQ6IHN0cmluZztcclxuICBzZW5kZXI6ICd1c2VyJyB8ICdib3QnO1xyXG4gIHRpbWVzdGFtcDogRGF0ZTtcclxufVxyXG5cclxuaW50ZXJmYWNlIENoYXRDb25maWcge1xyXG4gIHByb3ZpZGVyOiAnb3BlbmFpJyB8ICdtaW5pbWF4JyB8ICdub25lJztcclxuICBvcGVuYWlBcGlLZXk/OiBzdHJpbmc7XHJcbiAgbWluaW1heEFwaUtleT86IHN0cmluZztcclxufVxyXG5cclxuY29uc3QgUVVJQ0tfUkVQTElFUyA9IFtcclxuICAnwr9DdWFsIGVzIGVsIG1lam9yIGNvcnRlIHBhcmEgYXNhcj8nLFxyXG4gICfCv1RpZW5lbiBlbnZpbyBncmF0aXM/JyxcclxuICAnwr9Db21vIHByZXBhcm8gdW4gcmliZXllPycsXHJcbiAgJ1JlY29taWVuZGFtZSB1biBjb3J0ZScsXHJcbl07XHJcblxyXG5jb25zdCBNRUFUX0tOT1dMRURHRTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcclxuICAncmliZXllJzogJ0VsICoqUmliZXllKiogZXMgdW5vIGRlIGxvcyBjb3J0ZXMgbWFzIGp1Z29zb3MgeSBzYWJyb3Nvcy4gVGllbmUgZXhjZWxlbnRlIG1hcm1vbGVvIChncmFzYSBpbnRyYW11c2N1bGFyKSBxdWUgbGUgZGEgc2Fib3IuIElkZWFsIHBhcmEgbGEgcGFycmlsbGEgYSBmdWVnbyBhbHRvLCAzLTQgbWluIHBvciBsYWRvIHBhcmEgdGVybWlubyBtZWRpby4nLFxyXG4gICdhcnJhY2hlcmEnOiAnTGEgKipBcnJhY2hlcmEqKiBlcyBwZXJmZWN0YSBwYXJhIHRhY29zIHkgZmFqaXRhcy4gTWFyaW5hbGEgcG9yIGFsIG1lbm9zIDIgaG9yYXMgeSBjb2NpbmFsYSBhIGZ1ZWdvIGFsdG8gcG9yIDMtNCBtaW51dG9zIHBvciBsYWRvLiBDb3J0YWxhIGVuIGNvbnRyYSBkZSBsYSBmaWJyYS4nLFxyXG4gICduZXcgeW9yayc6ICdFbCAqKk5ldyBZb3JrKiogbyBTdHJpcCB0aWVuZSBtZW5vcyBncmFzYSBxdWUgZWwgcmliZXllIHBlcm8gZXMgbXV5IHRpZXJuby4gUGVyZmVjdG8gcGFyYSBwYXJyaWxsYSwgc2F6b25hIGNvbiBzYWwgZ3J1ZXNhIHkgcGltaWVudGEgYW50ZXMgZGUgY29jaW5hci4nLFxyXG4gICd0LWJvbmUnOiAnRWwgKipULUJvbmUqKiBpbmNsdXllIGRvcyBjb3J0ZXM6IGVsIGZpbGV0ZSB5IGVsIE5ldyBZb3JrLCBzZXBhcmFkb3MgcG9yIHVuIGh1ZXNvIGVuIGZvcm1hIGRlIFQuIElkZWFsIHBhcmEgcGFycmlsbGEsIGNvY2luYSBwcmltZXJvIGVsIGxhZG8gZGVsIGZpbGV0ZS4nLFxyXG4gICdmaWxldGUnOiAnRWwgKipGaWxldGUgTWlnbm9uKiogZXMgZWwgY29ydGUgbWFzIHRpZXJuby4gVGllbmUgcG9jYSBncmFzYSBhc2kgcXVlIG5vIGxvIGNvY2luZXMgZGUgbWFzLiBJZGVhbCB0ZXJtaW5vIG1lZGlvLXJvam8uJyxcclxuICAnYXNhZG8nOiAnUGFyYSAqKmFzYXIqKiByZWNvbWllbmRvOiBSaWJleWUgKGp1Z29zbyksIEFycmFjaGVyYSAocGFyYSB0YWNvcyksIFQtQm9uZSAoZG9zIGNvcnRlcyBlbiB1bm8pLCBvIE5ldyBZb3JrIChiYWxhbmNlIHBlcmZlY3RvKS4nLFxyXG4gICdlbnZpbyc6ICdPZnJlY2Vtb3MgKiplbnZpbyBncmF0aXMqKiBlbiBwZWRpZG9zIG1heW9yZXMgYSAkOTk5IE1YTi4gTG9zIHBlZGlkb3Mgc2UgZW50cmVnYW4gZW4gMjQtNDggaG9yYXMgY29uIGVtcGFxdWUgcmVmcmlnZXJhZG8gcGFyYSBtYW50ZW5lciBsYSBjYWRlbmEgZGUgZnJpby4nLFxyXG4gICdwcmVwYXJhcic6ICdUaXBzIGdlbmVyYWxlczogMSkgU2FjYSBsYSBjYXJuZSBkZWwgcmVmcmkgMzAgbWluIGFudGVzLCAyKSBTZWNhIGJpZW4gbGEgc3VwZXJmaWNpZSwgMykgU2F6b25hIGp1c3RvIGFudGVzIGRlIGNvY2luYXIsIDQpIERlamEgcmVwb3NhciA1IG1pbiBkZXNwdWVzIGRlIGNvY2luYXIuJyxcclxuICAncmVjb21lbmRhcic6ICfCv1BhcmEgcXVlIG9jYXNpb24gYnVzY2FzP1xcblxcbi0gKipQYXJyaWxsYWRhIGZhbWlsaWFyKio6IEFycmFjaGVyYSBvIFJpYmV5ZVxcbi0gKipDZW5hIHJvbWFudGljYSoqOiBGaWxldGUgTWlnbm9uXFxuLSAqKlRhY29zL0Zhaml0YXMqKjogQXJyYWNoZXJhIG1hcmluYWRhXFxuLSAqKkltcHJlc2lvbmFyIGludml0YWRvcyoqOiBULUJvbmUgbyBUb21haGF3aycsXHJcbiAgJ3ByZWNpbyc6ICdMb3MgcHJlY2lvcyB2YXJpYW4gc2VndW4gZWwgY29ydGUgeSBwZXNvLiBWaXNpdGEgbnVlc3RyYSBzZWNjaW9uIGRlIHByb2R1Y3RvcyBwYXJhIHZlciBwcmVjaW9zIGFjdHVhbGl6YWRvcy4gVGVuZW1vcyBvZmVydGFzIGVzcGVjaWFsZXMgcGFyYSBtaWVtYnJvcyEnLFxyXG4gICdtZW1icmVzaWEnOiAnTnVlc3RyYSAqKm1lbWJyZXNpYSBwcmVtaXVtKiogaW5jbHV5ZTogMTAlIGRlc2N1ZW50byBlbiB0b2RvcyBsb3MgcHJvZHVjdG9zLCBlbnZpbyBncmF0aXMgc2llbXByZSwgYWNjZXNvIGEgY29ydGVzIGV4Y2x1c2l2b3MgeSBwdW50b3MgZG9ibGVzIGVuIGNhZGEgY29tcHJhLicsXHJcbn07XHJcblxyXG5mdW5jdGlvbiBnZXRMb2NhbEJvdFJlc3BvbnNlKHVzZXJNZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGNvbnN0IG1zZyA9IHVzZXJNZXNzYWdlLnRvTG93ZXJDYXNlKCk7XHJcbiAgXHJcbiAgaWYgKG1zZy5pbmNsdWRlcygnaG9sYScpIHx8IG1zZy5pbmNsdWRlcygnYnVlbm9zJykgfHwgbXNnLmluY2x1ZGVzKCdoaScpKSB7XHJcbiAgICByZXR1cm4gJ0hvbGEhIFNveSBlbCBhc2lzdGVudGUgZGUgQ2FybmVzIFByZW1pdW0uIMK/RW4gcXVlIHB1ZWRvIGF5dWRhcnRlIGhveT8gUHVlZG8gcmVjb21lbmRhcnRlIGNvcnRlcywgZXhwbGljYXJ0ZSBjb21vIHByZXBhcmFybG9zIG8gYXl1ZGFydGUgY29uIHR1IHBlZGlkby4nO1xyXG4gIH1cclxuICBcclxuICBmb3IgKGNvbnN0IFtrZXksIHJlc3BvbnNlXSBvZiBPYmplY3QuZW50cmllcyhNRUFUX0tOT1dMRURHRSkpIHtcclxuICAgIGlmIChtc2cuaW5jbHVkZXMoa2V5KSkge1xyXG4gICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChtc2cuaW5jbHVkZXMoJ2FzYXInKSB8fCBtc2cuaW5jbHVkZXMoJ3BhcnJpbGxhJykgfHwgbXNnLmluY2x1ZGVzKCdncmlsbCcpKSB7XHJcbiAgICByZXR1cm4gTUVBVF9LTk9XTEVER0VbJ2FzYWRvJ107XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChtc2cuaW5jbHVkZXMoJ2VudmlvJykgfHwgbXNnLmluY2x1ZGVzKCdlbnRyZWdhJykgfHwgbXNnLmluY2x1ZGVzKCdncmF0aXMnKSkge1xyXG4gICAgcmV0dXJuIE1FQVRfS05PV0xFREdFWydlbnZpbyddO1xyXG4gIH1cclxuICBcclxuICBpZiAobXNnLmluY2x1ZGVzKCdwcmVwYXJhcicpIHx8IG1zZy5pbmNsdWRlcygnY29jaW5hcicpIHx8IG1zZy5pbmNsdWRlcygnaGFjZXInKSB8fCBtc2cuaW5jbHVkZXMoJ2NvbW8nKSkge1xyXG4gICAgcmV0dXJuIE1FQVRfS05PV0xFREdFWydwcmVwYXJhciddO1xyXG4gIH1cclxuICBcclxuICBpZiAobXNnLmluY2x1ZGVzKCdyZWNvbWllbmRhJykgfHwgbXNnLmluY2x1ZGVzKCdzdWdpZXJlcycpIHx8IG1zZy5pbmNsdWRlcygnbWVqb3InKSB8fCBtc2cuaW5jbHVkZXMoJ2N1YWwnKSkge1xyXG4gICAgcmV0dXJuIE1FQVRfS05PV0xFREdFWydyZWNvbWVuZGFyJ107XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChtc2cuaW5jbHVkZXMoJ3ByZWNpbycpIHx8IG1zZy5pbmNsdWRlcygnY3Vlc3RhJykgfHwgbXNnLmluY2x1ZGVzKCdjdWFudG8nKSB8fCBtc2cuaW5jbHVkZXMoJ3ZhbG9yJykpIHtcclxuICAgIHJldHVybiBNRUFUX0tOT1dMRURHRVsncHJlY2lvJ107XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChtc2cuaW5jbHVkZXMoJ21lbWJyZXNpYScpIHx8IG1zZy5pbmNsdWRlcygncHJlbWl1bScpIHx8IG1zZy5pbmNsdWRlcygnYmVuZWZpY2lvJykpIHtcclxuICAgIHJldHVybiBNRUFUX0tOT1dMRURHRVsnbWVtYnJlc2lhJ107XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChtc2cuaW5jbHVkZXMoJ2dyYWNpYXMnKSB8fCBtc2cuaW5jbHVkZXMoJ3RoYW5rcycpKSB7XHJcbiAgICByZXR1cm4gJ0NvbiBndXN0byEgU2kgdGllbmVzIG1hcyBwcmVndW50YXMgc29icmUgbnVlc3Ryb3MgY29ydGVzIG8gbmVjZXNpdGFzIGF5dWRhIGNvbiB0dSBwZWRpZG8sIGFxdWkgZXN0b3kuJztcclxuICB9XHJcbiAgXHJcbiAgaWYgKG1zZy5pbmNsdWRlcygnYWRpb3MnKSB8fCBtc2cuaW5jbHVkZXMoJ2J5ZScpIHx8IG1zZy5pbmNsdWRlcygnY2hhbycpKSB7XHJcbiAgICByZXR1cm4gJ0hhc3RhIHByb250byEgR3JhY2lhcyBwb3IgdmlzaXRhciBDYXJuZXMgUHJlbWl1bS4gUXVlIGRpc2ZydXRlcyB0dSBhc2FkbyEnO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gJ0ludGVyZXNhbnRlIHByZWd1bnRhLiBQdWVkbyBheXVkYXJ0ZSBjb246XFxuXFxuLSBJbmZvcm1hY2lvbiBzb2JyZSBjb3J0ZXMgZGUgY2FybmVcXG4tIFJlY29tZW5kYWNpb25lcyBzZWd1biBsYSBvY2FzaW9uXFxuLSBUaXBzIGRlIHByZXBhcmFjaW9uXFxuLSBJbmZvcm1hY2lvbiBkZSBlbnZpb3NcXG4tIERldGFsbGVzIGRlIG1lbWJyZXNpYVxcblxcbsK/U29icmUgcXVlIHRlIGd1c3RhcmlhIHNhYmVyIG1hcz8nO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDaGF0V2lkZ2V0KCkge1xyXG4gIGNvbnN0IHsgdXNlciwgaXNBdXRoZW50aWNhdGVkIH0gPSB1c2VBdXRoU2FmZSgpO1xyXG4gIGNvbnN0IFtpc09wZW4sIHNldElzT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW21lc3NhZ2VzLCBzZXRNZXNzYWdlc10gPSB1c2VTdGF0ZTxNZXNzYWdlW10+KFtcclxuICAgIHtcclxuICAgICAgaWQ6ICcxJyxcclxuICAgICAgdGV4dDogJ0hvbGEhIFNveSB0dSBhc2lzdGVudGUgZGUgQ2FybmVzIFByZW1pdW0uIMK/RW4gcXVlIHB1ZWRvIGF5dWRhcnRlIGhveT8nLFxyXG4gICAgICBzZW5kZXI6ICdib3QnLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICB9LFxyXG4gIF0pO1xyXG4gIGNvbnN0IFtpbnB1dFZhbHVlLCBzZXRJbnB1dFZhbHVlXSA9IHVzZVN0YXRlKCcnKTtcclxuICBjb25zdCBbaXNUeXBpbmcsIHNldElzVHlwaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbY2hhdENvbmZpZywgc2V0Q2hhdENvbmZpZ10gPSB1c2VTdGF0ZTxDaGF0Q29uZmlnPih7IHByb3ZpZGVyOiAnbm9uZScgfSk7XHJcbiAgY29uc3QgW2NoYXRIaXN0b3J5LCBzZXRDaGF0SGlzdG9yeV0gPSB1c2VTdGF0ZTxBcnJheTx7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH0+PihbXSk7XHJcbiAgY29uc3QgbWVzc2FnZXNFbmRSZWYgPSB1c2VSZWY8SFRNTERpdkVsZW1lbnQ+KG51bGwpO1xyXG5cclxuICAvLyBWZXJpZmljYXIgc2kgZWwgdXN1YXJpbyBhY3R1YWwgZXMgYWRtaW5pc3RyYWRvclxyXG4gIGNvbnN0IGlzQWRtaW4gPSBpc0F1dGhlbnRpY2F0ZWQgJiYgdXNlcj8ucm9sZSA9PT0gJ0FETUlOJztcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGNvbnN0IHNhdmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NoYXRDb25maWcnKTtcclxuICAgIGlmIChzYXZlZCkge1xyXG4gICAgICBzZXRDaGF0Q29uZmlnKEpTT04ucGFyc2Uoc2F2ZWQpKTtcclxuICAgIH1cclxuICB9LCBbXSk7XHJcblxyXG4gIGNvbnN0IHNjcm9sbFRvQm90dG9tID0gKCkgPT4ge1xyXG4gICAgbWVzc2FnZXNFbmRSZWYuY3VycmVudD8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcgfSk7XHJcbiAgfTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIHNjcm9sbFRvQm90dG9tKCk7XHJcbiAgfSwgW21lc3NhZ2VzXSk7XHJcblxyXG4gIGNvbnN0IGNhbGxBSUFQSSA9IGFzeW5jIChtZXNzYWdlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUElfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDIvYXBpJ30vY2hhdGAsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgICAgaGlzdG9yeTogY2hhdEhpc3RvcnksXHJcbiAgICAgICAgICBwcm92aWRlcjogY2hhdENvbmZpZy5wcm92aWRlcixcclxuICAgICAgICB9KSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGRhdGEuZXJyb3IgJiYgIWRhdGEubWVzc2FnZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLmVycm9yKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGRhdGEubWVzc2FnZTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0FJIEFQSSBFcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBnZXRMb2NhbEJvdFJlc3BvbnNlKG1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVNlbmQgPSBhc3luYyAodGV4dD86IHN0cmluZykgPT4ge1xyXG4gICAgY29uc3QgbWVzc2FnZVRleHQgPSB0ZXh0IHx8IGlucHV0VmFsdWUudHJpbSgpO1xyXG4gICAgaWYgKCFtZXNzYWdlVGV4dCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHVzZXJNZXNzYWdlOiBNZXNzYWdlID0ge1xyXG4gICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxyXG4gICAgICB0ZXh0OiBtZXNzYWdlVGV4dCxcclxuICAgICAgc2VuZGVyOiAndXNlcicsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgIH07XHJcbiAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIHVzZXJNZXNzYWdlXSk7XHJcbiAgICBzZXRJbnB1dFZhbHVlKCcnKTtcclxuXHJcbiAgICBzZXRDaGF0SGlzdG9yeSgocHJldikgPT4gWy4uLnByZXYsIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBtZXNzYWdlVGV4dCB9XSk7XHJcblxyXG4gICAgc2V0SXNUeXBpbmcodHJ1ZSk7XHJcblxyXG4gICAgbGV0IGJvdFJlc3BvbnNlOiBzdHJpbmc7XHJcblxyXG4gICAgaWYgKGNoYXRDb25maWcucHJvdmlkZXIgIT09ICdub25lJyAmJiAoY2hhdENvbmZpZy5vcGVuYWlBcGlLZXkgfHwgY2hhdENvbmZpZy5taW5pbWF4QXBpS2V5KSkge1xyXG4gICAgICBib3RSZXNwb25zZSA9IGF3YWl0IGNhbGxBSUFQSShtZXNzYWdlVGV4dCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA2MDAgKyBNYXRoLnJhbmRvbSgpICogNDAwKSk7XHJcbiAgICAgIGJvdFJlc3BvbnNlID0gZ2V0TG9jYWxCb3RSZXNwb25zZShtZXNzYWdlVGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SXNUeXBpbmcoZmFsc2UpO1xyXG5cclxuICAgIGNvbnN0IGJvdE1lc3NhZ2U6IE1lc3NhZ2UgPSB7XHJcbiAgICAgIGlkOiAoRGF0ZS5ub3coKSArIDEpLnRvU3RyaW5nKCksXHJcbiAgICAgIHRleHQ6IGJvdFJlc3BvbnNlLFxyXG4gICAgICBzZW5kZXI6ICdib3QnLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICB9O1xyXG4gICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFsuLi5wcmV2LCBib3RNZXNzYWdlXSk7XHJcbiAgICBzZXRDaGF0SGlzdG9yeSgocHJldikgPT4gWy4uLnByZXYsIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6IGJvdFJlc3BvbnNlIH1dKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVLZXlQcmVzcyA9IChlOiBSZWFjdC5LZXlib2FyZEV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgJiYgIWUuc2hpZnRLZXkpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBoYW5kbGVTZW5kKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDw+XHJcbiAgICAgIDxidXR0b25cclxuICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRJc09wZW4oIWlzT3Blbil9XHJcbiAgICAgICAgY2xhc3NOYW1lPXtgZml4ZWQgYm90dG9tLTYgcmlnaHQtNiB6LTUwIHctMTQgaC0xNCByb3VuZGVkLWZ1bGwgc2hhZG93LWxnIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTMwMCAke1xyXG4gICAgICAgICAgaXNPcGVuID8gJ2JnLWdyYXktNjAwIHJvdGF0ZS05MCcgOiAnYmctcmVkLTYwMCBob3ZlcjpiZy1yZWQtNzAwIGhvdmVyOnNjYWxlLTExMCdcclxuICAgICAgICB9YH1cclxuICAgICAgPlxyXG4gICAgICAgIHtpc09wZW4gPyAoXHJcbiAgICAgICAgICA8WCBjbGFzc05hbWU9XCJ3LTYgaC02IHRleHQtd2hpdGVcIiAvPlxyXG4gICAgICAgICkgOiAoXHJcbiAgICAgICAgICA8TWVzc2FnZUNpcmNsZSBjbGFzc05hbWU9XCJ3LTYgaC02IHRleHQtd2hpdGVcIiAvPlxyXG4gICAgICAgICl9XHJcbiAgICAgIDwvYnV0dG9uPlxyXG5cclxuICAgICAge2lzT3BlbiAmJiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBib3R0b20tMjQgcmlnaHQtNiB6LTUwIHctOTYgbWF4LXctW2NhbGMoMTAwdnctMnJlbSldIGJnLXdoaXRlIHJvdW5kZWQtMnhsIHNoYWRvdy0yeGwgb3ZlcmZsb3ctaGlkZGVuIGJvcmRlciBib3JkZXItZ3JheS0yMDBcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctZ3JhZGllbnQtdG8tciBmcm9tLXJlZC02MDAgdG8tcmVkLTcwMCBwLTQgdGV4dC13aGl0ZVwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0zXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMTAgaC0xMCBiZy13aGl0ZS8yMCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICAgICAgPEJvdCBjbGFzc05hbWU9XCJ3LTYgaC02XCIgLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cImZvbnQtc2VtaWJvbGRcIj5Bc2lzdGVudGUgUHJlbWl1bTwvaDM+XHJcbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1yZWQtMTAwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge2NoYXRDb25maWcucHJvdmlkZXIgIT09ICdub25lJyA/IGBJQTogJHtjaGF0Q29uZmlnLnByb3ZpZGVyfWAgOiAnVHUgZXhwZXJ0byBlbiBjYXJuZXMnfVxyXG4gICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICB7aXNBZG1pbiAmJiAoXHJcbiAgICAgICAgICAgICAgICA8TGlua1xyXG4gICAgICAgICAgICAgICAgICBocmVmPVwiL2FkbWluL3NldHRpbmdzL2NoYXRcIlxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJwLTIgaG92ZXI6Ymctd2hpdGUvMjAgcm91bmRlZC1mdWxsIHRyYW5zaXRpb24tY29sb3JzXCJcclxuICAgICAgICAgICAgICAgICAgdGl0bGU9XCJDb25maWd1cmFyIGNoYXRib3RcIlxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICA8U2V0dGluZ3MgY2xhc3NOYW1lPVwidy00IGgtNFwiIC8+XHJcbiAgICAgICAgICAgICAgICA8L0xpbms+XHJcbiAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImgtODAgb3ZlcmZsb3cteS1hdXRvIHAtNCBzcGFjZS15LTQgYmctZ3JheS01MFwiPlxyXG4gICAgICAgICAgICB7bWVzc2FnZXMubWFwKChtZXNzYWdlKSA9PiAoXHJcbiAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAga2V5PXttZXNzYWdlLmlkfVxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgZmxleCAke21lc3NhZ2Uuc2VuZGVyID09PSAndXNlcicgPyAnanVzdGlmeS1lbmQnIDogJ2p1c3RpZnktc3RhcnQnfWB9XHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BmbGV4IGl0ZW1zLXN0YXJ0IHNwYWNlLXgtMiBtYXgtdy1bODAlXSAke1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2Uuc2VuZGVyID09PSAndXNlcicgPyAnZmxleC1yb3ctcmV2ZXJzZSBzcGFjZS14LXJldmVyc2UnIDogJydcclxuICAgICAgICAgICAgICAgICAgfWB9XHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2B3LTggaC04IHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBmbGV4LXNocmluay0wICR7XHJcbiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnNlbmRlciA9PT0gJ3VzZXInID8gJ2JnLXJlZC02MDAnIDogJ2JnLWdyYXktMjAwJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1gfVxyXG4gICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAge21lc3NhZ2Uuc2VuZGVyID09PSAndXNlcicgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICA8VXNlciBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtd2hpdGVcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICA8Qm90IGNsYXNzTmFtZT1cInctNCBoLTQgdGV4dC1ncmF5LTYwMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BwLTMgcm91bmRlZC0yeGwgJHtcclxuICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2Uuc2VuZGVyID09PSAndXNlcidcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyAnYmctcmVkLTYwMCB0ZXh0LXdoaXRlIHJvdW5kZWQtdHItc20nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogJ2JnLXdoaXRlIHRleHQtZ3JheS04MDAgcm91bmRlZC10bC1zbSBzaGFkb3ctc20nXHJcbiAgICAgICAgICAgICAgICAgICAgfWB9XHJcbiAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHdoaXRlc3BhY2UtcHJlLWxpbmVcIj57bWVzc2FnZS50ZXh0fTwvcD5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgKSl9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB7aXNUeXBpbmcgJiYgKFxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBqdXN0aWZ5LXN0YXJ0XCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMlwiPlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctOCBoLTggcm91bmRlZC1mdWxsIGJnLWdyYXktMjAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPEJvdCBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtZ3JheS02MDBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy13aGl0ZSBwLTMgcm91bmRlZC0yeGwgcm91bmRlZC10bC1zbSBzaGFkb3ctc21cIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggc3BhY2UteC0xXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMiBoLTIgYmctZ3JheS00MDAgcm91bmRlZC1mdWxsIGFuaW1hdGUtYm91bmNlXCIgc3R5bGU9e3sgYW5pbWF0aW9uRGVsYXk6ICcwbXMnIH19PjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTIgaC0yIGJnLWdyYXktNDAwIHJvdW5kZWQtZnVsbCBhbmltYXRlLWJvdW5jZVwiIHN0eWxlPXt7IGFuaW1hdGlvbkRlbGF5OiAnMTUwbXMnIH19PjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTIgaC0yIGJnLWdyYXktNDAwIHJvdW5kZWQtZnVsbCBhbmltYXRlLWJvdW5jZVwiIHN0eWxlPXt7IGFuaW1hdGlvbkRlbGF5OiAnMzAwbXMnIH19PjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICApfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgPGRpdiByZWY9e21lc3NhZ2VzRW5kUmVmfSAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJweC00IHB5LTIgYm9yZGVyLXQgYm9yZGVyLWdyYXktMTAwIGJnLXdoaXRlXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LXdyYXAgZ2FwLTJcIj5cclxuICAgICAgICAgICAgICB7UVVJQ0tfUkVQTElFUy5tYXAoKHJlcGx5LCBpbmRleCkgPT4gKFxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICBrZXk9e2luZGV4fVxyXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVTZW5kKHJlcGx5KX1cclxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC14cyBweC0zIHB5LTEuNSBiZy1ncmF5LTEwMCBob3ZlcjpiZy1yZWQtNTAgaG92ZXI6dGV4dC1yZWQtNjAwIHJvdW5kZWQtZnVsbCB0cmFuc2l0aW9uLWNvbG9yc1wiXHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgIHtyZXBseX1cclxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC00IGJvcmRlci10IGJvcmRlci1ncmF5LTIwMCBiZy13aGl0ZVwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMlwiPlxyXG4gICAgICAgICAgICAgIDxpbnB1dFxyXG4gICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICAgICAgdmFsdWU9e2lucHV0VmFsdWV9XHJcbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldElucHV0VmFsdWUoZS50YXJnZXQudmFsdWUpfVxyXG4gICAgICAgICAgICAgICAgb25LZXlQcmVzcz17aGFuZGxlS2V5UHJlc3N9XHJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkVzY3JpYmUgdHUgcHJlZ3VudGEuLi5cIlxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxleC0xIHB4LTQgcHktMiBib3JkZXIgYm9yZGVyLWdyYXktMzAwIHJvdW5kZWQtZnVsbCBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctcmVkLTUwMCBmb2N1czpib3JkZXItdHJhbnNwYXJlbnQgdGV4dC1zbVwiXHJcbiAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVTZW5kKCl9XHJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17IWlucHV0VmFsdWUudHJpbSgpfVxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0xMCBoLTEwIGJnLXJlZC02MDAgaG92ZXI6YmctcmVkLTcwMCBkaXNhYmxlZDpiZy1ncmF5LTMwMCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdHJhbnNpdGlvbi1jb2xvcnNcIlxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxTZW5kIGNsYXNzTmFtZT1cInctNCBoLTQgdGV4dC13aGl0ZVwiIC8+XHJcbiAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcbiAgICA8Lz5cclxuICApO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKid1c2UgY2xpZW50JztcclxuXHJcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VSZWYsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTWVzc2FnZUNpcmNsZSwgWCwgU2VuZCwgQm90LCBVc2VyLCBTZXR0aW5ncyB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7XHJcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluayc7XHJcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICdAL2NvbnRleHQvQXV0aENvbnRleHQnO1xyXG5cclxuaW50ZXJmYWNlIE1lc3NhZ2Uge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdGV4dDogc3RyaW5nO1xyXG4gIHNlbmRlcjogJ3VzZXInIHwgJ2JvdCc7XHJcbiAgdGltZXN0YW1wOiBEYXRlO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ2hhdENvbmZpZyB7XHJcbiAgcHJvdmlkZXI6ICdvcGVuYWknIHwgJ21pbmltYXgnIHwgJ25vbmUnO1xyXG4gIG9wZW5haUFwaUtleT86IHN0cmluZztcclxuICBtaW5pbWF4QXBpS2V5Pzogc3RyaW5nO1xyXG59XHJcblxyXG5jb25zdCBRVUlDS19SRVBMSUVTID0gW1xyXG4gICfCv0N1YWwgZXMgZWwgbWVqb3IgY29ydGUgcGFyYSBhc2FyPycsXHJcbiAgJ8K/VGllbmVuIGVudmlvIGdyYXRpcz8nLFxyXG4gICfCv0NvbW8gcHJlcGFybyB1biByaWJleWU/JyxcclxuICAnUmVjb21pZW5kYW1lIHVuIGNvcnRlJyxcclxuXTtcclxuXHJcbmNvbnN0IE1FQVRfS05PV0xFREdFOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xyXG4gICdyaWJleWUnOiAnRWwgKipSaWJleWUqKiBlcyB1bm8gZGUgbG9zIGNvcnRlcyBtYXMganVnb3NvcyB5IHNhYnJvc29zLiBUaWVuZSBleGNlbGVudGUgbWFybW9sZW8gKGdyYXNhIGludHJhbXVzY3VsYXIpIHF1ZSBsZSBkYSBzYWJvci4gSWRlYWwgcGFyYSBsYSBwYXJyaWxsYSBhIGZ1ZWdvIGFsdG8sIDMtNCBtaW4gcG9yIGxhZG8gcGFyYSB0ZXJtaW5vIG1lZGlvLicsXHJcbiAgJ2FycmFjaGVyYSc6ICdMYSAqKkFycmFjaGVyYSoqIGVzIHBlcmZlY3RhIHBhcmEgdGFjb3MgeSBmYWppdGFzLiBNYXJpbmFsYSBwb3IgYWwgbWVub3MgMiBob3JhcyB5IGNvY2luYWxhIGEgZnVlZ28gYWx0byBwb3IgMy00IG1pbnV0b3MgcG9yIGxhZG8uIENvcnRhbGEgZW4gY29udHJhIGRlIGxhIGZpYnJhLicsXHJcbiAgJ25ldyB5b3JrJzogJ0VsICoqTmV3IFlvcmsqKiBvIFN0cmlwIHRpZW5lIG1lbm9zIGdyYXNhIHF1ZSBlbCByaWJleWUgcGVybyBlcyBtdXkgdGllcm5vLiBQZXJmZWN0byBwYXJhIHBhcnJpbGxhLCBzYXpvbmEgY29uIHNhbCBncnVlc2EgeSBwaW1pZW50YSBhbnRlcyBkZSBjb2NpbmFyLicsXHJcbiAgJ3QtYm9uZSc6ICdFbCAqKlQtQm9uZSoqIGluY2x1eWUgZG9zIGNvcnRlczogZWwgZmlsZXRlIHkgZWwgTmV3IFlvcmssIHNlcGFyYWRvcyBwb3IgdW4gaHVlc28gZW4gZm9ybWEgZGUgVC4gSWRlYWwgcGFyYSBwYXJyaWxsYSwgY29jaW5hIHByaW1lcm8gZWwgbGFkbyBkZWwgZmlsZXRlLicsXHJcbiAgJ2ZpbGV0ZSc6ICdFbCAqKkZpbGV0ZSBNaWdub24qKiBlcyBlbCBjb3J0ZSBtYXMgdGllcm5vLiBUaWVuZSBwb2NhIGdyYXNhIGFzaSBxdWUgbm8gbG8gY29jaW5lcyBkZSBtYXMuIElkZWFsIHRlcm1pbm8gbWVkaW8tcm9qby4nLFxyXG4gICdhc2Fkbyc6ICdQYXJhICoqYXNhcioqIHJlY29taWVuZG86IFJpYmV5ZSAoanVnb3NvKSwgQXJyYWNoZXJhIChwYXJhIHRhY29zKSwgVC1Cb25lIChkb3MgY29ydGVzIGVuIHVubyksIG8gTmV3IFlvcmsgKGJhbGFuY2UgcGVyZmVjdG8pLicsXHJcbiAgJ2VudmlvJzogJ09mcmVjZW1vcyAqKmVudmlvIGdyYXRpcyoqIGVuIHBlZGlkb3MgbWF5b3JlcyBhICQ5OTkgTVhOLiBMb3MgcGVkaWRvcyBzZSBlbnRyZWdhbiBlbiAyNC00OCBob3JhcyBjb24gZW1wYXF1ZSByZWZyaWdlcmFkbyBwYXJhIG1hbnRlbmVyIGxhIGNhZGVuYSBkZSBmcmlvLicsXHJcbiAgJ3ByZXBhcmFyJzogJ1RpcHMgZ2VuZXJhbGVzOiAxKSBTYWNhIGxhIGNhcm5lIGRlbCByZWZyaSAzMCBtaW4gYW50ZXMsIDIpIFNlY2EgYmllbiBsYSBzdXBlcmZpY2llLCAzKSBTYXpvbmEganVzdG8gYW50ZXMgZGUgY29jaW5hciwgNCkgRGVqYSByZXBvc2FyIDUgbWluIGRlc3B1ZXMgZGUgY29jaW5hci4nLFxyXG4gICdyZWNvbWVuZGFyJzogJ8K/UGFyYSBxdWUgb2Nhc2lvbiBidXNjYXM/XFxuXFxuLSAqKlBhcnJpbGxhZGEgZmFtaWxpYXIqKjogQXJyYWNoZXJhIG8gUmliZXllXFxuLSAqKkNlbmEgcm9tYW50aWNhKio6IEZpbGV0ZSBNaWdub25cXG4tICoqVGFjb3MvRmFqaXRhcyoqOiBBcnJhY2hlcmEgbWFyaW5hZGFcXG4tICoqSW1wcmVzaW9uYXIgaW52aXRhZG9zKio6IFQtQm9uZSBvIFRvbWFoYXdrJyxcclxuICAncHJlY2lvJzogJ0xvcyBwcmVjaW9zIHZhcmlhbiBzZWd1biBlbCBjb3J0ZSB5IHBlc28uIFZpc2l0YSBudWVzdHJhIHNlY2Npb24gZGUgcHJvZHVjdG9zIHBhcmEgdmVyIHByZWNpb3MgYWN0dWFsaXphZG9zLiBUZW5lbW9zIG9mZXJ0YXMgZXNwZWNpYWxlcyBwYXJhIG1pZW1icm9zIScsXHJcbiAgJ21lbWJyZXNpYSc6ICdOdWVzdHJhICoqbWVtYnJlc2lhIHByZW1pdW0qKiBpbmNsdXllOiAxMCUgZGVzY3VlbnRvIGVuIHRvZG9zIGxvcyBwcm9kdWN0b3MsIGVudmlvIGdyYXRpcyBzaWVtcHJlLCBhY2Nlc28gYSBjb3J0ZXMgZXhjbHVzaXZvcyB5IHB1bnRvcyBkb2JsZXMgZW4gY2FkYSBjb21wcmEuJyxcclxufTtcclxuXHJcbmZ1bmN0aW9uIGdldExvY2FsQm90UmVzcG9uc2UodXNlck1lc3NhZ2U6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgbXNnID0gdXNlck1lc3NhZ2UudG9Mb3dlckNhc2UoKTtcclxuICBcclxuICBpZiAobXNnLmluY2x1ZGVzKCdob2xhJykgfHwgbXNnLmluY2x1ZGVzKCdidWVub3MnKSB8fCBtc2cuaW5jbHVkZXMoJ2hpJykpIHtcclxuICAgIHJldHVybiAnSG9sYSEgU295IGVsIGFzaXN0ZW50ZSBkZSBDYXJuZXMgUHJlbWl1bS4gwr9FbiBxdWUgcHVlZG8gYXl1ZGFydGUgaG95PyBQdWVkbyByZWNvbWVuZGFydGUgY29ydGVzLCBleHBsaWNhcnRlIGNvbW8gcHJlcGFyYXJsb3MgbyBheXVkYXJ0ZSBjb24gdHUgcGVkaWRvLic7XHJcbiAgfVxyXG4gIFxyXG4gIGZvciAoY29uc3QgW2tleSwgcmVzcG9uc2VdIG9mIE9iamVjdC5lbnRyaWVzKE1FQVRfS05PV0xFREdFKSkge1xyXG4gICAgaWYgKG1zZy5pbmNsdWRlcyhrZXkpKSB7XHJcbiAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgaWYgKG1zZy5pbmNsdWRlcygnYXNhcicpIHx8IG1zZy5pbmNsdWRlcygncGFycmlsbGEnKSB8fCBtc2cuaW5jbHVkZXMoJ2dyaWxsJykpIHtcclxuICAgIHJldHVybiBNRUFUX0tOT1dMRURHRVsnYXNhZG8nXTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKG1zZy5pbmNsdWRlcygnZW52aW8nKSB8fCBtc2cuaW5jbHVkZXMoJ2VudHJlZ2EnKSB8fCBtc2cuaW5jbHVkZXMoJ2dyYXRpcycpKSB7XHJcbiAgICByZXR1cm4gTUVBVF9LTk9XTEVER0VbJ2VudmlvJ107XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChtc2cuaW5jbHVkZXMoJ3ByZXBhcmFyJykgfHwgbXNnLmluY2x1ZGVzKCdjb2NpbmFyJykgfHwgbXNnLmluY2x1ZGVzKCdoYWNlcicpIHx8IG1zZy5pbmNsdWRlcygnY29tbycpKSB7XHJcbiAgICByZXR1cm4gTUVBVF9LTk9XTEVER0VbJ3ByZXBhcmFyJ107XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChtc2cuaW5jbHVkZXMoJ3JlY29taWVuZGEnKSB8fCBtc2cuaW5jbHVkZXMoJ3N1Z2llcmVzJykgfHwgbXNnLmluY2x1ZGVzKCdtZWpvcicpIHx8IG1zZy5pbmNsdWRlcygnY3VhbCcpKSB7XHJcbiAgICByZXR1cm4gTUVBVF9LTk9XTEVER0VbJ3JlY29tZW5kYXInXTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKG1zZy5pbmNsdWRlcygncHJlY2lvJykgfHwgbXNnLmluY2x1ZGVzKCdjdWVzdGEnKSB8fCBtc2cuaW5jbHVkZXMoJ2N1YW50bycpIHx8IG1zZy5pbmNsdWRlcygndmFsb3InKSkge1xyXG4gICAgcmV0dXJuIE1FQVRfS05PV0xFREdFWydwcmVjaW8nXTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKG1zZy5pbmNsdWRlcygnbWVtYnJlc2lhJykgfHwgbXNnLmluY2x1ZGVzKCdwcmVtaXVtJykgfHwgbXNnLmluY2x1ZGVzKCdiZW5lZmljaW8nKSkge1xyXG4gICAgcmV0dXJuIE1FQVRfS05PV0xFREdFWydtZW1icmVzaWEnXTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKG1zZy5pbmNsdWRlcygnZ3JhY2lhcycpIHx8IG1zZy5pbmNsdWRlcygndGhhbmtzJykpIHtcclxuICAgIHJldHVybiAnQ29uIGd1c3RvISBTaSB0aWVuZXMgbWFzIHByZWd1bnRhcyBzb2JyZSBudWVzdHJvcyBjb3J0ZXMgbyBuZWNlc2l0YXMgYXl1ZGEgY29uIHR1IHBlZGlkbywgYXF1aSBlc3RveS4nO1xyXG4gIH1cclxuICBcclxuICBpZiAobXNnLmluY2x1ZGVzKCdhZGlvcycpIHx8IG1zZy5pbmNsdWRlcygnYnllJykgfHwgbXNnLmluY2x1ZGVzKCdjaGFvJykpIHtcclxuICAgIHJldHVybiAnSGFzdGEgcHJvbnRvISBHcmFjaWFzIHBvciB2aXNpdGFyIENhcm5lcyBQcmVtaXVtLiBRdWUgZGlzZnJ1dGVzIHR1IGFzYWRvISc7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiAnSW50ZXJlc2FudGUgcHJlZ3VudGEuIFB1ZWRvIGF5dWRhcnRlIGNvbjpcXG5cXG4tIEluZm9ybWFjaW9uIHNvYnJlIGNvcnRlcyBkZSBjYXJuZVxcbi0gUmVjb21lbmRhY2lvbmVzIHNlZ3VuIGxhIG9jYXNpb25cXG4tIFRpcHMgZGUgcHJlcGFyYWNpb25cXG4tIEluZm9ybWFjaW9uIGRlIGVudmlvc1xcbi0gRGV0YWxsZXMgZGUgbWVtYnJlc2lhXFxuXFxuwr9Tb2JyZSBxdWUgdGUgZ3VzdGFyaWEgc2FiZXIgbWFzPyc7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENoYXRXaWRnZXQoKSB7XHJcbiAgY29uc3QgeyB1c2VyLCBpc0F1dGhlbnRpY2F0ZWQgfSA9IHVzZUF1dGgoKTsgXHJcbiAgY29uc3QgW2lzT3Blbiwgc2V0SXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTsgIFxyXG4gIGNvbnN0IFttZXNzYWdlcywgc2V0TWVzc2FnZXNdID0gdXNlU3RhdGU8TWVzc2FnZVtdPihbXHJcbiAgICB7XHJcbiAgICAgIGlkOiAnMScsXHJcbiAgICAgIHRleHQ6ICdIb2xhISBTb3kgdHUgYXNpc3RlbnRlIGRlIENhcm5lcyBQcmVtaXVtLiDCv0VuIHF1ZSBwdWVkbyBheXVkYXJ0ZSBob3k/JyxcclxuICAgICAgc2VuZGVyOiAnYm90JyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgfSxcclxuICBdKTtcclxuICBjb25zdCBbaW5wdXRWYWx1ZSwgc2V0SW5wdXRWYWx1ZV0gPSB1c2VTdGF0ZSgnJyk7XHJcbiAgY29uc3QgW2lzVHlwaW5nLCBzZXRJc1R5cGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW2NoYXRDb25maWcsIHNldENoYXRDb25maWddID0gdXNlU3RhdGU8Q2hhdENvbmZpZz4oeyBwcm92aWRlcjogJ25vbmUnIH0pO1xyXG4gIGNvbnN0IFtjaGF0SGlzdG9yeSwgc2V0Q2hhdEhpc3RvcnldID0gdXNlU3RhdGU8QXJyYXk8eyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZyB9Pj4oW10pO1xyXG4gIGNvbnN0IG1lc3NhZ2VzRW5kUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcclxuICBjb25zdCBpc0FkbWluID0gaXNBdXRoZW50aWNhdGVkICYmIHVzZXI/LnJvbGUgPT09ICdBRE1JTic7IFxyXG5cclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIFxyXG4gICAgY29uc3Qgc2F2ZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2hhdENvbmZpZycpO1xyXG4gICAgaWYgKHNhdmVkKSB7XHJcbiAgICAgIHNldENoYXRDb25maWcoSlNPTi5wYXJzZShzYXZlZCkpO1xyXG4gICAgfVxyXG4gIH0sIFtdKTtcclxuXHJcbiAgY29uc3Qgc2Nyb2xsVG9Cb3R0b20gPSAoKSA9PiB7XHJcbiAgICBtZXNzYWdlc0VuZFJlZi5jdXJyZW50Py5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcclxuICB9O1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgc2Nyb2xsVG9Cb3R0b20oKTtcclxuICB9LCBbbWVzc2FnZXNdKTtcclxuXHJcbiAgY29uc3QgY2FsbEFJQVBJID0gYXN5bmMgKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQSV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMi9hcGknfS9jaGF0YCwge1xyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgICBoaXN0b3J5OiBjaGF0SGlzdG9yeSxcclxuICAgICAgICAgIHByb3ZpZGVyOiBjaGF0Q29uZmlnLnByb3ZpZGVyLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZGF0YS5lcnJvciAmJiAhZGF0YS5tZXNzYWdlKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEuZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gZGF0YS5tZXNzYWdlO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignQUkgQVBJIEVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIGdldExvY2FsQm90UmVzcG9uc2UobWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlU2VuZCA9IGFzeW5jICh0ZXh0Pzogc3RyaW5nKSA9PiB7XHJcbiAgICBjb25zdCBtZXNzYWdlVGV4dCA9IHRleHQgfHwgaW5wdXRWYWx1ZS50cmltKCk7XHJcbiAgICBpZiAoIW1lc3NhZ2VUZXh0KSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgdXNlck1lc3NhZ2U6IE1lc3NhZ2UgPSB7XHJcbiAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXHJcbiAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0LFxyXG4gICAgICBzZW5kZXI6ICd1c2VyJyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbLi4ucHJldiwgdXNlck1lc3NhZ2VdKTtcclxuICAgIHNldElucHV0VmFsdWUoJycpO1xyXG4gICAgc2V0Q2hhdEhpc3RvcnkoKHByZXYpID0+IFsuLi5wcmV2LCB7IHJvbGU6ICd1c2VyJywgY29udGVudDogbWVzc2FnZVRleHQgfV0pO1xyXG4gICAgc2V0SXNUeXBpbmcodHJ1ZSk7XHJcblxyXG4gICAgbGV0IGJvdFJlc3BvbnNlOiBzdHJpbmc7XHJcblxyXG4gICAgaWYgKGNoYXRDb25maWcucHJvdmlkZXIgIT09ICdub25lJyAmJiAoY2hhdENvbmZpZy5vcGVuYWlBcGlLZXkgfHwgY2hhdENvbmZpZy5taW5pbWF4QXBpS2V5KSkge1xyXG4gICAgICBib3RSZXNwb25zZSA9IGF3YWl0IGNhbGxBSUFQSShtZXNzYWdlVGV4dCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA2MDAgKyBNYXRoLnJhbmRvbSgpICogNDAwKSk7XHJcbiAgICAgIGJvdFJlc3BvbnNlID0gZ2V0TG9jYWxCb3RSZXNwb25zZShtZXNzYWdlVGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SXNUeXBpbmcoZmFsc2UpO1xyXG5cclxuICAgIGNvbnN0IGJvdE1lc3NhZ2U6IE1lc3NhZ2UgPSB7XHJcbiAgICAgIGlkOiAoRGF0ZS5ub3coKSArIDEpLnRvU3RyaW5nKCksXHJcbiAgICAgIHRleHQ6IGJvdFJlc3BvbnNlLFxyXG4gICAgICBzZW5kZXI6ICdib3QnLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICB9O1xyXG4gICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFsuLi5wcmV2LCBib3RNZXNzYWdlXSk7XHJcbiAgICBzZXRDaGF0SGlzdG9yeSgocHJldikgPT4gWy4uLnByZXYsIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6IGJvdFJlc3BvbnNlIH1dKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVLZXlQcmVzcyA9IChlOiBSZWFjdC5LZXlib2FyZEV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgJiYgIWUuc2hpZnRLZXkpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBoYW5kbGVTZW5kKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDw+XHJcbiAgICAgIDxidXR0b25cclxuICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRJc09wZW4oIWlzT3Blbil9XHJcbiAgICAgICAgY2xhc3NOYW1lPXtgZml4ZWQgYm90dG9tLTYgcmlnaHQtNiB6LTUwIHctMTQgaC0xNCByb3VuZGVkLWZ1bGwgc2hhZG93LWxnIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTMwMCAke1xyXG4gICAgICAgICAgaXNPcGVuID8gJ2JnLWdyYXktNjAwIHJvdGF0ZS05MCcgOiAnYmctcmVkLTYwMCBob3ZlcjpiZy1yZWQtNzAwIGhvdmVyOnNjYWxlLTExMCdcclxuICAgICAgICB9YH1cclxuICAgICAgPlxyXG4gICAgICAgIHtpc09wZW4gPyA8WCBjbGFzc05hbWU9XCJ3LTYgaC02IHRleHQtd2hpdGVcIiAvPiA6IDxNZXNzYWdlQ2lyY2xlIGNsYXNzTmFtZT1cInctNiBoLTYgdGV4dC13aGl0ZVwiIC8+fVxyXG4gICAgICA8L2J1dHRvbj5cclxuXHJcbiAgICAgIHtpc09wZW4gJiYgKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZml4ZWQgYm90dG9tLTI0IHJpZ2h0LTYgei01MCB3LTk2IG1heC13LVtjYWxjKDEwMHZ3LTJyZW0pXSBiZy13aGl0ZSByb3VuZGVkLTJ4bCBzaGFkb3ctMnhsIG92ZXJmbG93LWhpZGRlbiBib3JkZXIgYm9yZGVyLWdyYXktMjAwXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLWdyYWRpZW50LXRvLXIgZnJvbS1yZWQtNjAwIHRvLXJlZC03MDAgcC00IHRleHQtd2hpdGVcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW5cIj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtM1wiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTEwIGgtMTAgYmctd2hpdGUvMjAgcm91bmRlZC1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxCb3QgY2xhc3NOYW1lPVwidy02IGgtNlwiIC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJmb250LXNlbWlib2xkXCI+QXNpc3RlbnRlIFByZW1pdW08L2gzPlxyXG4gICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtcmVkLTEwMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIHtjaGF0Q29uZmlnLnByb3ZpZGVyICE9PSAnbm9uZScgPyBgSUE6ICR7Y2hhdENvbmZpZy5wcm92aWRlcn1gIDogJ1R1IGV4cGVydG8gZW4gY2FybmVzJ31cclxuICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPExpbmsgaHJlZj1cIi9hZG1pbi9zZXR0aW5ncy9jaGF0XCIgY2xhc3NOYW1lPVwicC0yIGhvdmVyOmJnLXdoaXRlLzIwIHJvdW5kZWQtZnVsbCB0cmFuc2l0aW9uLWNvbG9yc1wiIHRpdGxlPVwiQ29uZmlndXJhciBjaGF0Ym90XCI+XHJcbiAgICAgICAgICAgICAgICA8U2V0dGluZ3MgY2xhc3NOYW1lPVwidy00IGgtNFwiIC8+XHJcbiAgICAgICAgICAgICAgPC9MaW5rPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaC04MCBvdmVyZmxvdy15LWF1dG8gcC00IHNwYWNlLXktNCBiZy1ncmF5LTUwXCI+XHJcbiAgICAgICAgICAgIHttZXNzYWdlcy5tYXAoKG1lc3NhZ2UpID0+IChcclxuICAgICAgICAgICAgICA8ZGl2IGtleT17bWVzc2FnZS5pZH0gY2xhc3NOYW1lPXtgZmxleCAke21lc3NhZ2Uuc2VuZGVyID09PSAndXNlcicgPyAnanVzdGlmeS1lbmQnIDogJ2p1c3RpZnktc3RhcnQnfWB9PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BmbGV4IGl0ZW1zLXN0YXJ0IHNwYWNlLXgtMiBtYXgtdy1bODAlXSAke21lc3NhZ2Uuc2VuZGVyID09PSAndXNlcicgPyAnZmxleC1yb3ctcmV2ZXJzZSBzcGFjZS14LXJldmVyc2UnIDogJyd9YH0+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgdy04IGgtOCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZmxleC1zaHJpbmstMCAke21lc3NhZ2Uuc2VuZGVyID09PSAndXNlcicgPyAnYmctcmVkLTYwMCcgOiAnYmctZ3JheS0yMDAnfWB9PlxyXG4gICAgICAgICAgICAgICAgICAgIHttZXNzYWdlLnNlbmRlciA9PT0gJ3VzZXInID8gPFVzZXIgY2xhc3NOYW1lPVwidy00IGgtNCB0ZXh0LXdoaXRlXCIgLz4gOiA8Qm90IGNsYXNzTmFtZT1cInctNCBoLTQgdGV4dC1ncmF5LTYwMFwiIC8+fVxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BwLTMgcm91bmRlZC0yeGwgJHttZXNzYWdlLnNlbmRlciA9PT0gJ3VzZXInID8gJ2JnLXJlZC02MDAgdGV4dC13aGl0ZSByb3VuZGVkLXRyLXNtJyA6ICdiZy13aGl0ZSB0ZXh0LWdyYXktODAwIHJvdW5kZWQtdGwtc20gc2hhZG93LXNtJ31gfT5cclxuICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHdoaXRlc3BhY2UtcHJlLWxpbmVcIj57bWVzc2FnZS50ZXh0fTwvcD5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgKSl9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB7aXNUeXBpbmcgJiYgKCBcclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1zdGFydFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTJcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTggaC04IHJvdW5kZWQtZnVsbCBiZy1ncmF5LTIwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxCb3QgY2xhc3NOYW1lPVwidy00IGgtNCB0ZXh0LWdyYXktNjAwXCIgLz5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctd2hpdGUgcC0zIHJvdW5kZWQtMnhsIHJvdW5kZWQtdGwtc20gc2hhZG93LXNtXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IHNwYWNlLXgtMVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTIgaC0yIGJnLWdyYXktNDAwIHJvdW5kZWQtZnVsbCBhbmltYXRlLWJvdW5jZVwiIHN0eWxlPXt7IGFuaW1hdGlvbkRlbGF5OiAnMG1zJyB9fT48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0yIGgtMiBiZy1ncmF5LTQwMCByb3VuZGVkLWZ1bGwgYW5pbWF0ZS1ib3VuY2VcIiBzdHlsZT17eyBhbmltYXRpb25EZWxheTogJzE1MG1zJyB9fT48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0yIGgtMiBiZy1ncmF5LTQwMCByb3VuZGVkLWZ1bGwgYW5pbWF0ZS1ib3VuY2VcIiBzdHlsZT17eyBhbmltYXRpb25EZWxheTogJzMwMG1zJyB9fT48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIDxkaXYgcmVmPXttZXNzYWdlc0VuZFJlZn0gLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHgtNCBweS0yIGJvcmRlci10IGJvcmRlci1ncmF5LTEwMCBiZy13aGl0ZVwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC13cmFwIGdhcC0yXCI+XHJcbiAgICAgICAgICAgICAge1FVSUNLX1JFUExJRVMubWFwKChyZXBseSwgaW5kZXgpID0+IChcclxuICAgICAgICAgICAgICAgIDxidXR0b24ga2V5PXtpbmRleH0gb25DbGljaz17KCkgPT4gaGFuZGxlU2VuZChyZXBseSl9IGNsYXNzTmFtZT1cInRleHQteHMgcHgtMyBweS0xLjUgYmctZ3JheS0xMDAgaG92ZXI6YmctcmVkLTUwIGhvdmVyOnRleHQtcmVkLTYwMCByb3VuZGVkLWZ1bGwgdHJhbnNpdGlvbi1jb2xvcnNcIj5cclxuICAgICAgICAgICAgICAgICAge3JlcGx5fVxyXG4gICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgKSl9XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTQgYm9yZGVyLXQgYm9yZGVyLWdyYXktMjAwIGJnLXdoaXRlXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0yXCI+XHJcbiAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgICB2YWx1ZT17aW5wdXRWYWx1ZX1cclxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0SW5wdXRWYWx1ZShlLnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAgICAgICBvbktleVByZXNzPXtoYW5kbGVLZXlQcmVzc31cclxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRXNjcmliZSB0dSBwcmVndW50YS4uLlwiXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LTEgcHgtNCBweS0yIGJvcmRlciBib3JkZXItZ3JheS0zMDAgcm91bmRlZC1mdWxsIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1yZWQtNTAwIGZvY3VzOmJvcmRlci10cmFuc3BhcmVudCB0ZXh0LXNtXCJcclxuICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gaGFuZGxlU2VuZCgpfSBkaXNhYmxlZD17IWlucHV0VmFsdWUudHJpbSgpfSBjbGFzc05hbWU9XCJ3LTEwIGgtMTAgYmctcmVkLTYwMCBob3ZlcjpiZy1yZWQtNzAwIGRpc2FibGVkOmJnLWdyYXktMzAwIHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0cmFuc2l0aW9uLWNvbG9yc1wiPlxyXG4gICAgICAgICAgICAgICAgPFNlbmQgY2xhc3NOYW1lPVwidy00IGgtNCB0ZXh0LXdoaXRlXCIgLz5cclxuICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgKX1cclxuICAgIDwvPlxyXG4gICk7XHJcbn0qLyJdLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZVJlZiIsInVzZUVmZmVjdCIsIk1lc3NhZ2VDaXJjbGUiLCJYIiwiU2VuZCIsIkJvdCIsIlVzZXIiLCJTZXR0aW5ncyIsIkxpbmsiLCJ1c2VBdXRoU2FmZSIsImF1dGhTdGF0ZSIsInNldEF1dGhTdGF0ZSIsInVzZXIiLCJpc0F1dGhlbnRpY2F0ZWQiLCJzYXZlZFVzZXIiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2F2ZWRUb2tlbiIsIkpTT04iLCJwYXJzZSIsIlFVSUNLX1JFUExJRVMiLCJNRUFUX0tOT1dMRURHRSIsImdldExvY2FsQm90UmVzcG9uc2UiLCJ1c2VyTWVzc2FnZSIsIm1zZyIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJrZXkiLCJyZXNwb25zZSIsIk9iamVjdCIsImVudHJpZXMiLCJDaGF0V2lkZ2V0IiwiaXNPcGVuIiwic2V0SXNPcGVuIiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsImlkIiwidGV4dCIsInNlbmRlciIsInRpbWVzdGFtcCIsIkRhdGUiLCJpbnB1dFZhbHVlIiwic2V0SW5wdXRWYWx1ZSIsImlzVHlwaW5nIiwic2V0SXNUeXBpbmciLCJjaGF0Q29uZmlnIiwic2V0Q2hhdENvbmZpZyIsInByb3ZpZGVyIiwiY2hhdEhpc3RvcnkiLCJzZXRDaGF0SGlzdG9yeSIsIm1lc3NhZ2VzRW5kUmVmIiwiaXNBZG1pbiIsInJvbGUiLCJzYXZlZCIsInNjcm9sbFRvQm90dG9tIiwiY3VycmVudCIsInNjcm9sbEludG9WaWV3IiwiYmVoYXZpb3IiLCJjYWxsQUlBUEkiLCJtZXNzYWdlIiwiZmV0Y2giLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQVBJX1VSTCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwic3RyaW5naWZ5IiwiaGlzdG9yeSIsImRhdGEiLCJqc29uIiwiZXJyb3IiLCJFcnJvciIsImNvbnNvbGUiLCJoYW5kbGVTZW5kIiwibWVzc2FnZVRleHQiLCJ0cmltIiwibm93IiwidG9TdHJpbmciLCJwcmV2IiwiY29udGVudCIsImJvdFJlc3BvbnNlIiwib3BlbmFpQXBpS2V5IiwibWluaW1heEFwaUtleSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIk1hdGgiLCJyYW5kb20iLCJib3RNZXNzYWdlIiwiaGFuZGxlS2V5UHJlc3MiLCJlIiwic2hpZnRLZXkiLCJwcmV2ZW50RGVmYXVsdCIsImJ1dHRvbiIsIm9uQ2xpY2siLCJjbGFzc05hbWUiLCJkaXYiLCJoMyIsInAiLCJocmVmIiwidGl0bGUiLCJtYXAiLCJzdHlsZSIsImFuaW1hdGlvbkRlbGF5IiwicmVmIiwicmVwbHkiLCJpbmRleCIsImlucHV0IiwidHlwZSIsInZhbHVlIiwib25DaGFuZ2UiLCJ0YXJnZXQiLCJvbktleVByZXNzIiwicGxhY2Vob2xkZXIiLCJkaXNhYmxlZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/components/ChatWidget.tsx\n"));

/***/ })

});